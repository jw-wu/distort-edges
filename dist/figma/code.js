(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function r(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((o=o.apply(e,t||[])).next())}))};class t{constructor(){this.modules=new Map}loadModule(e){this.modules.set(e.getCommand(),e)}matchCommandToModule(e){return this.modules.get(e)||null}moduleCount(){return this.modules.size}runSoloModule(){this.modules.values().next().value.run()}getSoloModule(){return this.modules.values().next().value}}const n=e=>"RECTANGLE"===e.type||"ELLIPSE"===e.type||"POLYGON"===e.type||"STAR"===e.type||"VECTOR"===e.type||"BOOLEAN_OPERATION"===e.type,o=!1,s=3,i="#fa0",a="#4caf50";function r(e,t){o&&(t?console.log(`%c${e}`,`color: ${t}`):console.log(e))}function l(e){return Math.round(e*Math.pow(10,s))/Math.pow(10,s)}const c="color: #C191FF;",d="color: #f30;";class h{constructor(e){var t,n,o;this.commands=[],this.nsew=[0,0,0,0];const s={firstCoords:{x:0,y:0},previousCoords:{x:0,y:0},currentCoords:{x:0,y:0},area:0,vectorCommands:[]};let i=e.split(" ");for(let e of i)if(/[MLQCZ]/i.test(e)){let t={type:e,handles:[],coords:{x:NaN,y:NaN},origin:{x:NaN,y:NaN},winding:"clockwise"};if(this.commands.push(t),"Z"!==e)s.vectorCommands.push(t),s.previousCoords=Object.assign({},s.currentCoords);else{s.area+=this._getWindingArea(s.currentCoords,s.firstCoords);const e=s.area>0?"counter-clockwise":"clockwise";for(let t=0;t<s.vectorCommands.length;++t)s.vectorCommands[t].winding=e}}else{const i=this.commands[this.commands.length-1],a=Number(e);switch(i.type){case"M":case"L":if(isNaN(i.coords.x))i.coords.x=a,this._setEW(a),"M"===i.type&&(s.firstCoords.x=a),s.currentCoords.x=a;else{i.coords.y=a;const e=null!==(t=this.getPreviousCommand(i))&&void 0!==t?t:{coords:{x:0,y:0}};i.origin="M"===i.type?i.coords:e.coords,this._setNS(a),"M"===i.type&&(s.firstCoords.y=a),s.currentCoords.y=a,"M"!==i.type&&(s.area+=this._getWindingArea(s.previousCoords,s.currentCoords))}break;case"C":if(0===i.handles.length)i.handles.push({x:a,y:NaN});else if(1===i.handles.length&&isNaN(i.handles[0].y))i.handles[0].y=a;else if(1===i.handles.length)i.handles.push({x:a,y:NaN});else if(2===i.handles.length&&isNaN(i.handles[1].y))i.handles[1].y=a;else if(isNaN(i.coords.x))i.coords.x=a,this._setEW(a),s.currentCoords.x=a;else{i.coords.y=a;const e=null!==(n=this.getPreviousCommand(i))&&void 0!==n?n:{coords:{x:0,y:0}};i.origin=e.coords,this._setNS(a),s.currentCoords.y=a,s.area+=this._getWindingArea(s.previousCoords,s.currentCoords)}break;case"Q":if(0===i.handles.length)i.handles.push({x:a,y:NaN});else if(1===i.handles.length)i.handles[0].y=a;else if(isNaN(i.coords.x))i.coords.x=a,this._setEW(a),s.currentCoords.x=a;else{i.coords.y=a;const e=null!==(o=this.getPreviousCommand(i))&&void 0!==o?o:{coords:{x:0,y:0}};i.origin=e.coords,this._setNS(a),s.currentCoords.y=a,s.area+=this._getWindingArea(s.previousCoords,s.currentCoords)}break;case"Z":const e=this.getPreviousCommand(i);if(e&&e.coords!==this.getCommand(0).coords){let t=this.getCommand(0);this.commands.push({type:"L",handles:[],coords:{x:t.coords.x,y:t.coords.y},origin:e.coords,winding:s.area>0?"counter-clockwise":"clockwise"})}}}}_setNS(e){e<this.nsew[0]?this.nsew[0]=e:e>this.nsew[1]&&(this.nsew[1]=e)}_setEW(e){e<this.nsew[3]?this.nsew[3]=e:e>this.nsew[2]&&(this.nsew[2]=e)}_getWindingArea(e,t){return(t.x-e.x)*(t.y+t.y)}size(){return this.commands.length}getCommandIndex(e){return this.commands.indexOf(e)}getCommand(e){return this.commands[e]}getFirstCommandOnPath(e,t){t=null==t||t;const n=this.getCommandIndex(e);let o=e;if(n>0){for(let e=n-1;e>=0;--e)if(0===e)o=this.getCommand(0);else if("Z"===this.getCommand(e).type){let n=e+1;if(t)o=this.getCommand(n);else{for(;"M"===this.getCommand(n).type;)++n;o=this.getCommand(n)}break}}else 0===n?o=e:console.error("Vector command not found in model.");return o}getLastCommandOnPath(e,t){t=null==t||t;const n=this.size(),o=this.getCommandIndex(e);let s=e;if(o>=0){for(let e=o;e<n;++e)if(s=this.getCommand(e),"Z"===this.getCommand(e).type){t||(s=this.getCommand(e-1));break}}else console.error("Vector command not found in model.");return s}getPreviousCommand(e){const t=this.commands.indexOf(e);return 0===t?(console.log("%cLast command in library retrieved as current command is the first.",c),this.commands[this.commands.length-1]):t>0?this.commands[t-1]:(console.log(`%cNo such command found. Command requested: ${JSON.stringify(e)}`,d),null)}getNextCommand(e){const t=this.commands.indexOf(e);return t===this.size()-1?(console.log("%cFirst command of library retrieved as current command is the last.",c),this.commands[0]):t>-1?this.commands[t+1]:(console.log(`%cNo such command found. Command requested: ${JSON.stringify(e)}`,d),null)}saveCoords(e,t){const n=this.getCommandIndex(e);this.getCommand(n).coords={x:t.x,y:t.y}}saveHandle(e,t){const n=this.getCommandIndex(e);this.getCommand(n).handles=t}getBoundingBox(){return{width:this.nsew[2]-this.nsew[3],height:this.nsew[1]-this.nsew[0]}}}function u(e){return e*(Math.PI/180)}function m(e){let t=0;if(void 0===e.adjacentSide||isNaN(e.adjacentSide)||(++t,e.adjacentSide=Math.abs(e.adjacentSide)),void 0===e.oppositeSide||isNaN(e.oppositeSide)||(++t,e.oppositeSide=Math.abs(e.oppositeSide)),void 0===e.angle||isNaN(e.angle)||(++t,e.angle=Math.abs(e.angle)),t<2)console.log("%cNot enough values to calculate the hypotenuse of the triangle.","color: #f30;");else{if("number"==typeof e.adjacentSide&&"number"==typeof e.oppositeSide)return Math.sqrt(e.adjacentSide*e.adjacentSide+e.oppositeSide*e.oppositeSide)||0;if("number"==typeof e.oppositeSide&&"number"==typeof e.angle)return Math.abs(e.oppositeSide/Math.sin(u(e.angle)));if("number"==typeof e.adjacentSide&&"number"==typeof e.angle)return Math.abs(e.adjacentSide/Math.cos(u(e.angle)))}return null}const g=3;function f(e){return Math.round(e*Math.pow(10,g))/Math.pow(10,g)}function p(e,t){return{x:t.x+(t.x-e.x),y:t.y+(t.y-e.y)}}function y(e,t,n){return"before"===n?{x:e.x-t.x,y:e.y-t.y}:{x:e.x+t.x,y:e.y+t.y}}function x(e,t,n,o){return 0===n.length?C(e,t,o):1===n.length?b(e,n[0],t,o):2===n.length?N(e,n[0],n[1],t,o):(console.error('More than 2 handles received for getPointOnPath. Parameter "handles" should not contain more than 2 Vectors.'),null)}function C(e,t,n){const o=e.x+n*(t.x-e.x),s=e.y+n*(t.y-e.y);return{x:f(o),y:f(s)}}function b(e,t,n,o){const s={handle1:C(e,t,o),handle2:C(t,n,o)};return C(s.handle1,s.handle2,o)}function N(e,t,n,o,s){const i={handle1:C(e,t,s),middle:C(t,n,s),handle2:C(n,o,s)},a={handle1:C(i.handle1,i.middle,s),handle2:C(i.middle,i.handle2,s)};return C(a.handle1,a.handle2,s)}function v(e,t){const n=0-e.x,o=0-e.y,s={x:t.x+n,y:t.y+o};return f(Math.atan2(-s.y,s.x)*(180/Math.PI))}function S(e,t){const n=e*(Math.PI/180),o=t*Math.cos(n),s=t*Math.sin(n);return{x:f(o),y:f(-s)}}function P(e,t){let n="clockwise"===t?e-90:e+90;return n>360?n-=360:n<0&&(n+=360),f(n)}function D(e,t,n,o){if(0===n)return t;{const s=S(P(e,o),n);return{x:t.x+s.x,y:t.y+s.y}}}class M extends h{constructor(e,t){super(e),this.pathSegments=[],this.perimeter=0;for(let e of this.commands){const n=this._getPathSegment(e,t);n&&this.pathSegments.push(n),this._generateSubpoints(e,this.getLastPathSegment()),this.perimeter+=this.getLastPathSegment().pathLength}}_getPathSegment(e,t){var n,o;if("M"===e.type||"Z"===e.type)return{pathLength:0,subSegments:0,increments:[],subpoints:[]};if("L"===e.type||"Q"===e.type||"C"===e.type){const s=this.getPreviousCommand(e);let i={pathLength:0,subSegments:0,increments:[],subpoints:[]};if(s){if("L"===e.type?i.pathLength=function(e,t){const n=m({adjacentSide:Math.abs(e.x-t.x),oppositeSide:Math.abs(e.y-t.y)});return null!=n?f(n):NaN}(s.coords,e.coords):"Q"===e.type?i.pathLength=function(e,t,n){let o=0;for(let s=1;s<30;++s){const i=b(e,t,n,s/30),a=b(e,t,n,(s+1)/30),r=m({adjacentSide:Math.abs(i.x-a.x),oppositeSide:Math.abs(i.y-a.y)});if("number"!=typeof r){console.error("Calculated segment length for quadratic path length returned as null.");break}o+=f(r)}return f(o)}(s.coords,e.handles[0],e.coords):"C"===e.type&&(i.pathLength=function(e,t,n,o){let s=0;for(let i=1;i<30;++i){const a=N(e,t,n,o,i/30),r=N(e,t,n,o,(i+1)/30),l=m({adjacentSide:Math.abs(a.x-r.x),oppositeSide:Math.abs(a.y-r.y)});if("number"!=typeof l){console.error("Calculated segment length for cubic path length returned as null.");break}s+=f(l)}return f(s)}(s.coords,e.handles[0],e.handles[1],e.coords)),t.variableDistanceApart){const e=this._getVariableDistances(i.pathLength,null!==(n=t.minDistanceApart)&&void 0!==n?n:0,null!==(o=t.maxDistanceApart)&&void 0!==o?o:0);i.subSegments=e.length,i.increments=[...e]}else{const n=0!==t.distanceApart&&t.distanceApart?t.distanceApart:.1*i.pathLength,o=this._getUniformDistances(e,i.pathLength,null!=n?n:0,t.keepWithinOriginalSize,t.maximumDistortionDistance);i.subSegments=o.length,i.increments=[...o]}return i}console.error("Previous command could not be retreived as Vector Command could not be found.")}return null}_generateSubpoints(e,t){let n=0;if("M"===e.type)n=this.getCommandIndex(e),this.getPathSegmentByCommand(e).subpoints.push({coords:e.coords,slope:0,segmentDistance:0});else if("Z"!==e.type){let n=x(e.origin,e.coords,e.handles,t.increments[0]),o=e.origin,s=t.increments[0];for(let i=0;i<t.subSegments;++i){const a=t.increments[i]*t.pathLength;let r={x:NaN,y:NaN};const l=this.getPreviousCommand(e);if(0===i&&l&&"M"!==l.type&&"Z"!==l.type){const e=this.getPathSegmentByCommand(l);let t=e.subpoints[e.subpoints.length-1];const o=x(l.origin,l.coords,l.handles,1-e.increments[e.increments.length-1]),s=n;o?t.slope=v(o,s):console.error("Starting point of slope cannot be determined.")}i!==t.subSegments-1?(s+=t.increments[i+1],r=x(e.origin,e.coords,e.handles,s),this.getPathSegmentByCommand(e).subpoints.push({coords:n,slope:v(o,r),segmentDistance:a})):this.getPathSegmentByCommand(e).subpoints.push({coords:n,slope:0,segmentDistance:a}),o=n,n=r}}else{this.getPathSegmentByCommand(e).subpoints.push({coords:{x:NaN,y:NaN},slope:0,segmentDistance:0});const t=this.getPreviousCommand(e);if(t){const e=this.getPathSegmentByCommand(t),o=1-e.increments[e.increments.length-1];let s=e.subpoints[e.subpoints.length-1];const i=this.getCommand(n+1),a=this.getPathSegmentByCommand(i),r=v(x(t.origin,t.coords,t.handles,o),x(i.origin,i.coords,i.handles,a.increments[0]));s.slope=r,this.getPathSegmentByCommand(this.getCommand(n)).subpoints[0].slope=r}}}_getUniformDistances(e,t,n,o,s){let i=[];if(t<=n)i.push(1);else if(o&&"L"===e.type){const e=2*s/t,o=t-4*s;i.push(e);const a=Math.round(o/n),r=o/a/t;for(let e=0;e<a;++e)i.push(r);i.push(e)}else{const e=Math.round(t/n),o=t/e/t;for(let t=0;t<e;++t)i.push(o)}return i}_getVariableDistances(e,t,n){let o=[],s=e;const i=0===t?.2:t/e,a=0===n?.5:n/e,r=i*e;for(;s>0;){let t=l((c=i,d=a,Math.round(100*(Math.random()*(d-c)+c))/100/2*e));if(s<=r){0===o.length?o.push(1):o[o.length-1]+=l(s/e);break}t>s&&(t=s),o.push(t/e),s-=t}var c,d;return 0===o.length&&o.push(1),o}getLastPathSegment(){return this.pathSegments[this.pathSegments.length-1]}getPathSegmentByCommand(e){return this.pathSegments[this.getCommandIndex(e)]}getPerimeter(){return this.perimeter}}class w{constructor(e,t){this.x=e/2,this.y=t/2,this.n=this.y,this.s=this.y,this.e=this.x,this.w=this.x}discern(e){e.x>this.e?this.e=e.x:e.x<this.w&&(this.w=e.x),e.y>this.s?this.s=e.y:e.y<this.n&&(this.n=e.y)}getCoords(){return{x:this.x-this.w,y:this.y-this.n}}}function $(e,t,n){r("Starting distortedges-startingpoint.create()",i);const o=e.getLastCommandOnPath(t,!1),s=e.getNextCommand(t);if(s){const i=e.getPathSegmentByCommand(o),c=n.distanceApart?n.distanceApart:i.increments[i.increments.length-1]*i.pathLength,d=x(o.origin,o.coords,o.handles,l((i.pathLength-c)/i.pathLength)),h=e.getPathSegmentByCommand(s),u=n.distanceApart?n.distanceApart:h.increments[0]*i.pathLength,m=x(s.origin,s.coords,s.handles,l(u/h.pathLength));if(d&&m){let o,s={coords:{x:NaN,y:NaN},handleAngle:NaN},i=0;if(n.keepWithinOriginalSize||(i=n.variableDistortionDistance?Math.random()*n.maximumDistortionDistance:n.maximumDistortionDistance),0===i)o=t.origin;else{const e=S(P(v(d,m),"counter-clockwise"),i);o={x:t.origin.x+e.x,y:t.origin.y+e.y}}let l=`M ${o.x} ${o.y}`;const c=v(d,m);e.getPathSegmentByCommand(t).subpoints=[{coords:o,slope:c,segmentDistance:0}];const h=e.getLastCommandOnPath(t);return e.getPathSegmentByCommand(h).subpoints=[{coords:o,slope:-c,segmentDistance:0}],s.coords=o,s.handleAngle=c,r("Completed distortedges-startingpoint.create(). Result type: "+typeof l,a),{path:l,previousSubpoint:s}}}return r("Completed distortedges-startingpoint.create(). Result type: null","#f30"),null}function k(e,t,n,o,s){var c,d;r("Starting distortedges-uniformdistance.create()",i);let h="",u=e.getPathSegmentByCommand(t),m={half:{offset:NaN,rotation:"counter-clockwise",coords:{x:NaN,y:NaN},slope1:NaN,slope2:NaN,handleDistance1:{x:NaN,y:NaN},handleDistance2:{x:NaN,y:NaN},handle1:{x:NaN,y:NaN},handle2:{x:NaN,y:NaN}},full:{offset:NaN,rotation:"counter-clockwise",coords:{x:NaN,y:NaN},slope1:NaN,slope2:NaN,handleDistance1:{x:NaN,y:NaN},handleDistance2:{x:NaN,y:NaN},handle1:{x:NaN,y:NaN},handle2:{x:NaN,y:NaN}}};const g="clockwise"===t.winding?"clockwise":"counter-clockwise",f="clockwise"===t.winding?"counter-clockwise":"clockwise",p=e.getPreviousCommand(t),x=e.getNextCommand(t),b=u.subSegments-1;for(let i=0;i<u.subSegments;++i){const a=0!==n.handleDistancePeak||0!==n.handleDistanceTrough,r="Z"===(null==x?void 0:x.type)&&i===b;if(n.variableDistortionDistance)if(n.keepWithinOriginalSize)m.half.offset=Math.random()*(2*n.maximumDistortionDistance),m.full.offset=Math.random()*(2*n.maximumDistortionDistance),m.half.rotation=g,m.full.rotation=g;else{m.half.offset=Math.random()*n.maximumDistortionDistance,m.full.offset=Math.random()*n.maximumDistortionDistance;let e=Math.ceil(2*Math.random());m.half.rotation=1===e?g:f,e=Math.ceil(2*Math.random()),m.half.rotation=1===e?g:f}else n.keepWithinOriginalSize?(m.half.offset=n.maximumDistortionDistance,m.full.offset=0):(m.half.offset=0,m.full.offset=n.maximumDistortionDistance),m.half.rotation=g,m.full.rotation=f;const N=u.subpoints[i],P=0===i?t.origin:u.subpoints[i-1].coords,M=C(P,N.coords,.5);let w=v(P,N.coords);if("L"===t.type&&(0===i?w+=22.5:i===b&&(w-=22.5)),m.half.coords=D(w,M,m.half.offset,m.half.rotation),n.keepWithinOriginalSize)m.full.coords=N.coords;else if(r){const n=e.getFirstCommandOnPath(t),o=e.getPathSegmentByCommand(n);m.full.coords=o.subpoints[0].coords}else m.full.coords=D(N.slope,N.coords,m.full.offset,m.full.rotation);if(a){if(p&&0===i){const t=e.getPathSegmentByCommand(p),n=t.subpoints.length-1;m.half.slope1=t.subpoints[n].slope}else m.half.slope1=s.handleAngle;m.half.slope2=v(P,N.coords),m.full.slope1=m.half.slope2,m.full.slope2=N.slope;const t=null!==(c=n.handleDistancePeak)&&void 0!==c?c:.25,o=null!==(d=n.handleDistanceTrough)&&void 0!==d?d:.25,a=.5*N.segmentDistance,r=s.coords;m.half.handleDistance1=S(m.half.slope1,a*t),m.half.handle1=y(r,m.half.handleDistance1,"after"),m.half.handleDistance2=S(m.half.slope2,a*o),m.half.handle2=y(m.half.coords,m.half.handleDistance2,"before"),m.full.handleDistance1=S(m.full.slope1,a*o),m.full.handle1=y(m.half.coords,m.full.handleDistance1,"after"),m.full.handleDistance2=S(m.full.slope2,a*t),m.full.handle2=y(m.full.coords,m.full.handleDistance2,"before")}o.discern(m.half.coords),o.discern(m.full.coords),s.coords=m.full.coords,a&&(s.handleAngle=m.full.slope2),h=a?[h,"C",l(m.half.handle1.x),l(m.half.handle1.y),l(m.half.handle2.x),l(m.half.handle2.y),l(m.half.coords.x),l(m.half.coords.y),"C",l(m.full.handle1.x),l(m.full.handle1.y),l(m.full.handle2.x),l(m.full.handle2.y),l(m.full.coords.x),l(m.full.coords.y)].join(" "):[h,"L",l(m.half.coords.x),l(m.half.coords.y),"L",l(m.full.coords.x),l(m.full.coords.y)].join(" ")}return r("Completed distortedges-variabledistance.distort(). Result type: "+typeof h,a),{path:h.trim(),previousSubpoint:s}}function A(e){let t=e;if(/d=\"/.test(e)){const n=e.indexOf("d=")+3,o=e.substring(n).indexOf('"')+n;t=e.substring(n,o)}for(;t.search(/([MLHVCSQAZ]\d)|(\d[MLHVCSQAZ])|(Z[MLHVCSQAZ])/i)>-1;){const e=t.search(/([A-Z]\d)|(\d[A-Z])|([A-Z][A-Z])/i)+1;t=[t.substring(0,e),t.substring(e)].join(" ")}return function(e){let t=0,n=0,o="";const s=new RegExp("[MLVHCSQTAZ]","i");let i="",a={x:0,y:0};for(;e.search(s)>-1;){let r=e.search(s),l=e.substring(r,r+1),c=[];switch("Z"!==l&&([c,e]=O(e)),l){case"M":t=c[0],n=c[1],o=0===o.length?`${l} ${t} ${n}`:`${o} ${l} ${t} ${n}`;break;case"L":t=c[0],n=c[1],o=0===o.length?`M ${t} ${n} ${l} ${t} ${n}`:`${o} ${l} ${t} ${n}`;break;case"H":t=c[0],o=`${o} L ${t} ${n}`;break;case"V":n=c[0],o=`${o} L ${t} ${n}`;break;case"C":t=c[4],n=c[5],o=`${o} C ${c[0]} ${c[1]} ${c[2]} ${c[3]} ${t} ${n}`,a={x:c[2],y:c[3]};break;case"S":if(t=c[2],n=c[3],"C"===i||"S"==i){const e=p(a,{x:t,y:n});o=`${o} C ${e.x} ${e.y} ${c[0]} ${c[1]} ${t} ${n}`}else o=`${o} C ${t} ${n} ${c[0]} ${c[1]} ${t} ${n}`;a={x:c[0],y:c[1]};break;case"Q":t=c[2],n=c[3],o=`${o} Q ${c[0]} ${c[1]} ${t} ${n}`,a={x:c[0],y:c[1]};break;case"T":if(t=c[0],n=c[1],"Q"===i||"T"===i){const e=p(a,{x:t,y:n});o=`${o} Q ${e.x} ${e.y} ${t} ${n}`,a={x:e.x,y:e.y}}else o=`${o} L ${t} ${n}`;break;case"Z":o=`${o} Z`,e=e.search(/Z./)>-1?e.substring(1):""}i=l}return o}(t)}function O(e){const t=e.search(/[-\d]/),n=e.substring(t).search(/[MLVHCSQTAZ]/i)+t,o=e.substring(t,n).split(" ");let s=[];for(let e of o)isNaN(Number(e))||s.push(Number(Number(e).toFixed(15)));return[s,e.substring(n)]}class L{constructor(e,t){"string"!=typeof e&&console.error('Parameter "input" needs to be a string when creating a new DistortedNode object.'),function(e){void 0===e.variableDistortionDistance?console.error('Parameter "variableDistortionDistance" missing.'):"boolean"!=typeof e.variableDistortionDistance&&console.error('Parameter "variableDistortionDistance" needs to be a boolean.'),e.maximumDistortionDistance?"number"!=typeof e.maximumDistortionDistance&&console.error('Parameter "maximumDistortionDistance" needs to be a number.'):console.error('Parameter "maximumDistortionDistance" missing.'),void 0===e.variableDistanceApart?console.error('Parameter "variableDistanceApart" missing.'):"boolean"!=typeof e.variableDistanceApart&&console.error('Parameter "variableDistanceApart" needs to be a boolean.'),e.variableDistanceApart||e.distanceApart?e.variableDistanceApart||"number"==typeof e.distanceApart||console.error('Parameter "distanceApart" needs to be a number.'):console.error('Parameter "distanceApart" missing.'),void 0===e.handleDistancePeak?console.error('Parameter "handleDistancePeak" missing.'):"number"!=typeof e.handleDistancePeak&&console.error('Parameter "handleDistancePeak" needs to be a number.'),void 0===e.handleDistanceTrough?console.error('Parameter "handleDistanceTrough" missing.'):"number"!=typeof e.handleDistanceTrough&&console.error('Parameter "handleDistanceTrough" needs to be a number.'),void 0===e.keepWithinOriginalSize?console.error('Parameter "keepWithinOriginalSize" missing.'):"boolean"!=typeof e.keepWithinOriginalSize&&console.error('Parameter "keepWithinOriginalSize" needs to be a boolean.')}(t),r("Received recipe:"),r(t),e=e.includes("<svg")?function(e){let t=[];for(;e.includes("<path");){const n=e.indexOf("<path"),o=e.indexOf(">");t.push(e.substring(n,o+1)),e=e.substring(o+1)}let n="";for(let e of t)n=0===n.length?A(e):[n,A(e)].join(" ");return n}(e):A(e),this.recipe=t,this.model=new M(e,t)}getDrawCommands(e){return e&&(this.recipe=e),this._distortEdges().path}getAll(e){return e&&(this.recipe=e),this._distortEdges()}_distortEdges(){r("Starting distortedges.distortEdges()",i);let e="",t=new w(this.model.getBoundingBox().width,this.model.getBoundingBox().height),n={coords:{x:NaN,y:NaN},handleAngle:NaN};for(let o=0;o<this.model.size();++o){const s=this.model.getCommand(o);switch(s.type){case"M":const o=$(this.model,s,this.recipe);o?(e=0===e.length?`${o.path}`:`${e} ${o.path}`,n=o.previousSubpoint):console.error("Starting point could not be created.");break;case"L":case"C":const i=k(this.model,s,this.recipe,t,n);e=`${e} ${i.path}`,n=i.previousSubpoint;break;case"Z":e=`${e} Z`}}const o={path:e,center:t.getCoords()};return r("Completed distortedges.distortEdges()",a),r(o),o}}var I=function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function r(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((o=o.apply(e,t||[])).next())}))};function _(e,t){return I(this,void 0,void 0,(function*(){const n=e.rotation;e.rotation=0;const o=figma.flatten([e.clone()],figma.currentPage),s=e.getPluginData("svgCode"),i=0===s.length?yield function(e){return t=this,n=void 0,s=function*(){let t=yield e.exportAsync({format:"SVG",svgOutlineText:!0,svgIdAttribute:!1,svgSimplifyStroke:!1});return String.fromCharCode.apply(null,Array.from(t))},new((o=void 0)||(o=Promise))((function(e,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,r)}l((s=s.apply(t,n||[])).next())}));var t,n,o,s}(o):s;let a=new L(i,t).getAll(),r=figma.createFrame();if(e.parent){let t=e.parent.children.indexOf(e);e.parent.insertChild(t+1,r)}r.x=e.x,r.y=e.y,r.resize(e.width,e.height),r.fills=[],r.clipsContent=!1;let l=figma.createVector();return r.appendChild(l),l.vectorPaths=[{windingRule:"EVENODD",data:a.path}],t.keepWithinOriginalSize?(l.x=0,l.y=0):(l.x=r.width/2-a.center.x,l.y=r.height/2-a.center.y),l.strokes=e.strokes,l.strokeStyleId=e.strokeStyleId,l.strokeWeight=e.strokeWeight,l.strokeCap=e.strokeCap,l.strokeJoin=e.strokeJoin,l.dashPattern=e.dashPattern,l.strokeMiterLimit=e.strokeMiterLimit,l.fills=e.fills,l.fillStyleId=e.fillStyleId,l.opacity=e.opacity,l.blendMode=e.blendMode,l.effects=e.effects,l.effectStyleId=e.effectStyleId,l.name=`${e.name}`,r.name=`${e.name} (Original size)`,r.rotation=n,l.setPluginData("svgCode",i),l.setPluginData("recipe",JSON.stringify(t)),l.setPluginData("boundingBox",JSON.stringify({x:r.x,y:r.y,width:r.width,height:r.height})),r.setPluginData("enclosedNode",l.id),o.remove(),e.rotation=n,e.visible=!1,r}))}function B(e,t){const n=new L(e.getPluginData("svgCode"),t).getAll(),o=[{windingRule:e.vectorPaths[0].windingRule,data:n.path}];e.vectorPaths=o;const s=e.getPluginData("boundingBox");if(s){const t=JSON.parse(s);t.width&&t.height&&(e.x=t.width/2-n.center.x,e.y=t.height/2-n.center.y)}e.setPluginData("recipe",JSON.stringify(t))}function E(){const e=figma.currentPage.selection;if(1===e.length)if(n(e[0])){const t=e[0].getPluginData("recipe");if(0!==t.length){const e=JSON.parse(t);figma.ui.postMessage({command:"loadPropertiesOntoUI",args:{recipe:e}})}}else if("FRAME"===e[0].type){const t=e[0].getPluginData("enclosedNode");if(t.length>0){const n=e[0].findOne((e=>e.id===t));if(n){const e=n.getPluginData("recipe");if(0!==e.length){const t=JSON.parse(e);figma.ui.postMessage({command:"loadPropertiesOntoUI",args:{recipe:t}})}}}}}const Z=[new class{constructor(t,n,o,s){this.command=t,this.hasUI=n,this.userParameters={};const i=(()=>e(this,void 0,void 0,(function*(){}))).constructor;this.isAsync=o instanceof i,this.fn=o,n&&!s&&console.log("Module should have UI but does not have any means to parse input from the UI."),this.uiCommands=null!=s?s:()=>{}}setParameterSuggestion(e,t){this.userParameters[e]?this.userParameters[e].push(t):this.userParameters[e]=[t]}getCommand(){return this.command}parameterExists(e,t){return this.userParameters[e].indexOf(t)>=0}getParameterSuggestions(e){return this.userParameters[e]||[]}run(t){return e(this,void 0,void 0,(function*(){let e=t||{};return this.isAsync?yield this.fn(e):this.fn(e)}))}parseUICommands(e){this.uiCommands(e)}}("runDistortEdges",!0,(()=>{figma.showUI(__html__,{themeColors:!0}),figma.on("selectionchange",E)}),(e=>I(void 0,void 0,void 0,(function*(){"runPlugin"===e.command&&(yield function(e){return I(this,void 0,void 0,(function*(){const t=figma.currentPage.selection;if(0!==t.length){let o=[];for(let s of t){if("FRAME"===s.type&&s.getPluginData("enclosedNode").length>0){let t=s.findOne((e=>e.id===s.getPluginData("enclosedNode")));t&&"VECTOR"===t.type&&t.getPluginData("svgCode").length>0&&(B(t,e),o.push(s))}"VECTOR"===s.type&&s.getPluginData("svgCode").length>0?(B(s,e),o.push(s)):n(s)&&o.push(yield _(s,e))}0===o.length?figma.notify("No valid layers detected!",{timeout:3e3}):(figma.currentPage.selection=o,1===o.length?(figma.notify("Layer distorted.",{timeout:3e3}),figma.ui.postMessage({command:"loadPropertiesOntoUI",args:{recipe:e}})):(figma.notify("Layers distorted.",{timeout:3e3}),figma.ui.postMessage({command:"clearUI",args:{}})))}else figma.notify("No selection detected!",{timeout:3e3})}))}(e.args.recipe))}))))];console.log("%cPlugin has started.","color: #ccc");let W,T=function(e){let n=new t;if(e.length>0){for(let t of e)n.loadModule(t),console.log(`%cModule loaded: ${t.getCommand()}`,"color: #ccc");return n}return null}(Z);figma.parameters.on("input",(({parameters:e,key:t,result:n})=>{if(T){let e=T.matchCommandToModule(figma.command);e&&n.setSuggestions(e.getParameterSuggestions(t))}})),figma.on("run",(({parameters:e})=>{return t=void 0,n=void 0,s=function*(){e&&(console.log("%cUser input logged:","color: #ccc"),console.log(e)),T||(figma.notify("No operation modules loaded.",{timeout:5e3,error:!0}),figma.closePlugin()),T?(W=0===figma.command.length&&1===T.moduleCount()?T.getSoloModule():T.matchCommandToModule(figma.command),0===figma.command.length&&1===T.moduleCount()?T.runSoloModule():W?(W.isAsync?yield W.run(e):W.run(e),W.hasUI||figma.closePlugin()):(figma.notify("Selected operation has no corresponding module loaded! Closing plugin...",{timeout:5e3,error:!0}),figma.closePlugin())):figma.closePlugin()},new((o=void 0)||(o=Promise))((function(e,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function r(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,r)}l((s=s.apply(t,n||[])).next())}));var t,n,o,s})),figma.ui.onmessage=e=>{"ui"===e.call?"resize"===e.command&&figma.ui.resize(e.args.width,e.args.height):"module"===e.call&&(null==W?void 0:W.hasUI)&&(delete e.call,W.parseUICommands(e))}})();